# ğŸš€ Brand-Reputation-Crisis-Detection-System (Microsoft Fabric)

![Microsoft Fabric](https://img.shields.io/badge/Microsoft%20Fabric-60A5FA?style=for-the-badge&logo=microsoft&logoColor=white)
![PySpark](https://img.shields.io/badge/PySpark-E25A1C?style=for-the-badge&logo=apachespark&logoColor=white)
![Python](https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white)
![Hugging Face](https://img.shields.io/badge/Hugging%20Face-FFD21E?style=for-the-badge&logo=huggingface&logoColor=black)
![Power BI](https://img.shields.io/badge/Power%20BI-F2C811?style=for-the-badge&logo=powerbi&logoColor=black)
![Delta Lake](https://img.shields.io/badge/Delta%20Lake-00A1E0?style=for-the-badge&logo=deltalake&logoColor=white)

A real-time data engineering & AI-powered monitoring system that tracks competitor-related news, detects negative sentiment spikes, and visualizes insights on an interactive Power BI dashboard.

This project is built on **Microsoft Fabric**, using a **Medallion Architecture (Bronze â†’ Silver â†’ Gold)** with PySpark, Delta Lake, and Transformers-based ML models.

---

## ğŸ“Œ Project Overview

This system automatically:
- Ingests real-time news from DuckDuckGo
- Cleans and deduplicates content using PySpark
- Enriches data with AI sentiment classification
- Stores structured & enriched data in Delta format
- Displays negative PR trends using Power BI
- Runs as a fully automated daily pipeline

### ğŸ› ï¸ Key Features
- **Full Medallion Architecture** (Bronze Raw â†’ Silver Clean â†’ Gold AI Enriched)
- **Distributed Processing** using Microsoft Fabric Spark
- **Hugging Face Transformers** integrated via Pandas UDF
- **Delta Lake MERGE** for idempotent updates
- **Daily Scheduled Pipelines** with Failure Alerts
- **Executive Dashboard** to track competitor sentiment

---

## ğŸ—ï¸ Architecture & Tech Stack

| Layer | Technology | Purpose |
|-------|------------|---------|
| **Data Ingestion** | Python, DuckDuckGo API | Collects competitor-related articles |
| **Storage** | OneLake (Delta/Parquet) | Central unified data layer |
| **Processing** | PySpark (Fabric Notebook) | Cleaning, transformation, enrichment |
| **ML/AI** | Transformers (BERT), Pandas UDF | Sentiment detection |
| **Orchestration** | Fabric Data Pipelines | Automation & scheduling |
| **Visualization** | Power BI | Insight dashboards for leadership |

---

## ğŸ“Š Sample Data Flow

Here is how data transforms through the layers of the Medallion Architecture.

### 1. ğŸŸ¡ Bronze Layer (Raw Ingestion)
*Raw JSON data ingested from the web search API.*

```json
[
  {
    "title": "Snowflake and Accenture partnership...",
    "url": "[https://www.tmcnet.com/](https://www.tmcnet.com/)...",
    "ingestion_time": "2025-12-06T19:24:44Z",
    "raw_html": "<div>...</div>"
  }
]
```


## ğŸ“¸ Project Visuals

### ğŸ—ï¸ **Architecture Diagram**

![Architecture](dashboard/Architecture_diagram.png)

### ğŸ“Š **Power BI Dashboard**

![Power BI](dashboard/dashboard_screenshot.jpg)

### ğŸ”„ **Fabric Pipeline Execution**

![Pipeline Runs](dashboard/pipeline_run_success.png)

---

### 2\. âšª Silver Layer (Cleaned & Deduplicated)

*Structured Delta Table with types cast and nulls handled.*

| Date | Competitor | Source | Snippet |
| :--- | :--- | :--- | :--- |
| 2025-12-06 | Snowflake | TMCnet | On December 3, Accenture plc and Snowflake announced... |
| 2025-12-06 | Snowflake | Yahoo Finance | Accenture plc is included among the 15 Blue Chip stocks... |

### 3\. ğŸŸ¡ Gold Layer (AI Predictions)

*Final enriched table with Sentiment Labels and Confidence Scores generated by the BERT model.*

| Date | Competitor | Sentiment | Score | Snippet |
| :--- | :--- | :--- | :--- | :--- |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9979 | On December 3, Accenture plc (NYSE:ACN) and Snowflake, the AI data cloud company, announced an expanded partnership aimed at accelerating generative AI... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9898 | Accenture plc (NYSE:ACN) is included among the 15 Blue Chip Dividend Stocks to Build a Passive Income Portfolio... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9979 | On December 3, Accenture plc (NYSE:ACN) and Snowflake, the AI data cloud company, announced an expanded partnership aimed at accelerating generative AI... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9898 | Accenture plc (NYSE:ACN) is included among the 15 Blue Chip Dividend Stocks to Build a Passive Income Portfolio. On December 3... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9979 | On December 3, Accenture plc (NYSE:ACN) and Snowflake, the AI data cloud company, announced an expanded partnership aimed at accelerating generative AI... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9898 | Accenture plc (NYSE:ACN) is included among the 15 Blue Chip Dividend Stocks to Build a Passive Income Portfolio... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9979 | On December 3, Accenture plc (NYSE:ACN) and Snowflake, the AI data cloud company, announced an expanded partnership aimed at accelerating generative AI... |
| 2025-12-06 | Snowflake Data Cloud | **POSITIVE** | 0.9898 | Accenture plc (NYSE:ACN) is included among the 15 Blue Chip Dividend Stocks to Build a Passive Income Portfolio. On December 3... |
| 2025-12-06 | Microsoft Fabric | **NEGATIVE** | 0.9245 | Users reporting minor latency issues in the East US region during high-load data ingestion spike... |
| 2025-12-06 | Databricks | **POSITIVE** | 0.8841 | Analysts predict strong Q4 growth driven by new Lakehouse adoption metrics released this week... |

-----

## ğŸ”§ Engineering Challenges & Solutions

A professional summary of debugging and architectural decisions made during development.

### ğŸ”´ **Challenge 1: Pipeline Failing with Mismatched JSON Output**

**Error:** `MismatchedInputException: No content to map due to end-of-input`
**Solution:** Fabric expects a structured JSON exit output. I implemented `mssparkutils.notebook.exit()` with a structured JSON response instead of simple print logs.

### ğŸ”´ **Challenge 2: Schema Drift â€“ Missing Column in Silver Layer**

**Error:** `UNRESOLVED_COLUMN: body`
**Solution:** The source API changed and returned `snippet` instead of `body`. I added dynamic column mapping using `coalesce` logic to make the pipeline resilient to upstream schema changes.

### ğŸ”´ **Challenge 3: Missing Dependencies in Gold Notebook**

**Error:** `ModuleNotFoundError: transformers`
**Solution:** The default environment lacked ML libraries. I implemented a localized installation script to detect and install `transformers` and `torch` dynamically at runtime.

-----

## ğŸ“ Repository Structure

```
fabric-market-pulse/
â”‚
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_Ingest_Bronze.ipynb
â”‚   â”œâ”€â”€ 02_Process_Silver.ipynb
â”‚   â””â”€â”€ 03_Enrich_Gold.ipynb
â”‚
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ dashboard_screenshot.png
â”‚   â”œâ”€â”€ pipeline_run_success.png
â”‚   â””â”€â”€ architecture_diagram.png
â”‚
â”œâ”€â”€ data_samples/
â”‚   â””â”€â”€ sample_output.json
â”‚
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

-----

## ğŸš€ How to Run the Project

1.  **Upload notebooks** to Microsoft Fabric Workspace
2.  **Create a Lakehouse** named: `Lh_Market_Pulse`
3.  **Run notebooks sequentially** or build a Fabric Data Pipeline
4.  **Schedule the pipeline** (daily recommended)
5.  **Publish Power BI dashboard** connected to Gold Layer

-----

## ğŸ‘¨â€ğŸ’» Author

**Name:** Rahul Bastia 
**Tech:** Microsoft Fabric, PySpark, Transformers, Delta Lake, Power BI
